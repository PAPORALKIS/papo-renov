<!DOCTYPE html><html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, 
    viewport-fit=cover" />
  <title>Carrousel 3D - Réalisations</title>
  
  <style>
    /* Valeurs par défaut - desktop */
    
:root {
  --img-size: 150px;
  --translateZ: 900px;
  --offset: -250px;
  --perspective: 3000px;
  --container-top: 30%;
  --container-left: 45%;
  --container-translate-x: -50%;
  --container-translate-y: -49%;
  --camera-tilt: 4deg;
}

/* Smartphones portrait */
@media (max-width: 600px) and (orientation: portrait) {
  :root {
    --img-size: 17vw;
    --translateZ: 320px;
    --offset: -100px;
    --perspective: 2250px;
    --container-top: 50%;
    --container-left: 50%;
    --container-translate-x: -50%;
    --container-translate-y: -50%;
    --camera-tilt: 20deg;
  }
}

/* Smartphones paysage */
@media (max-width: 767px) and (orientation: landscape) {
  :root {
    --img-size: 13vw;
    --translateZ: 320px;
    --offset: -150px;
    --perspective: 1500px;
    --container-top: 50%;
    --container-left: 50%;
    --container-translate-x: -50%;
    --container-translate-y: -50%;
    --camera-tilt: 20deg;
  }
}

/* Tablettes (768px à 1024px) */
@media (min-width: 768px) and (max-width: 1024px) {
  :root {
    --img-size: 6vw;
    --translateZ: 3500px;
    --offset: -400px;
    --perspective: 4500px;
    --container-top: 50%;
    --container-left: 50%;
    --container-translate-x: -50%;
    --container-translate-y: -50%;
    --camera-tilt: 20deg;
  }
}
      </style>
</head>
<body>
  <!-- ===== Entête de page ===== -->
  <header>
    <div class="logo">
      <img src="../img/logo.png" alt="Logo Paporalkis">
    </div>
    <nav>
      <ul>
        <li><a href="../index.html">Accueil</a></li>
        <li><a href="devis.html">Demande de devis</a></li>
        <li><a href="realisations.html">Mes réalisations</a></li>
        <li><a href="tarifs.html">Tarifs</a></li>
        <li><a href="planning.html">Planning</a></li>
        <li><a href="contact.html" class="active">Contact</a></li>
      </ul>
    </nav>
  </header>  <!-- ===== Titre de la page ===== -->  <div class="page-title">Mes réalisations</div>  <!-- ===== Zoom Overlay (image en grand + vignettes) ===== -->  <div class="zoom-overlay" id="zoomOverlay">
    <div class="zoom-description" id="zoomDescription"></div>
    <img class="zoom-image" id="zoomImage" src="" alt="Zoom" />
    <div class="zoom-thumbnails" id="zoomThumbnails"></div>
  </div>  <!-- ===== Conteneur du carrousel ===== -->  <div class="carousel-container" id="carousel-container">
    <div class="carousel" id="carousel">
      <!-- Toutes les images à afficher dans le carrousel -->
      <img src="../img/CHBR0.jpg" alt="test" class="carousel__image" />
      <img src="../img/CHBR1.jpg" alt="test" class="carousel__image" />
      <img src="../img/CUIEXT.jpg"  alt="test" class="carousel__image" />
      <img src="../img/CUIEXT1.jpg" alt="test" class="carousel__image" />
      <img src="../img/CUIEXT2.jpg" alt="test" class="carousel__image" />
      <img src="../img/CUIEXT3.jpg" alt="test" class="carousel__image" />
      <img src="../img/CUIEXT4.jpg" alt="test" class="carousel__image" />
      <img src="../img/CUIEXT5.jpg" alt="test" class="carousel__image" />
      <img src="../img/CUIEXT6.jpg" alt="test" class="carousel__image" />
      <img src="../img/CUIMARS1.jpg" alt="test" class="carousel__image" />
      <img src="../img/CUIMARS2.jpg" alt="test" class="carousel__image" />
      <img src="../img/CUIMARS3.jpg" alt="test" class="carousel__image" />
      <img src="../img/CUIMARS4.jpg" alt="test" class="carousel__image" />
      <img src="../img/Iso2.jpg" alt="test" class="carousel__image" />
      <img src="../img/Iso3.jpg" alt="test" class="carousel__image" />
      <img src="../img/Iso4.jpg" alt="test" class="carousel__image" />
      <img src="../img/Iso5.jpg" alt="test" class="carousel__image" />
      <img src="../img/Iso6.jpg" alt="test" class="carousel__image" />
      <img src="../img/SDB1.jpg" alt="test" class="carousel__image" />
      <img src="../img/SDB2.jpg"  alt="test" class="carousel__image"/>
      <img src="../img/SDB3.jpg" alt="test" class="carousel__image" />
      <img src="../img/SDB4.jpg" alt="test" class="carousel__image" />
      <img src="../img/SDB5.jpg" alt="test" class="carousel__image" />
      <img src="../img/WC2.jpg" alt="test" class="carousel__image" />
      <img src="../img/cuisine_exterieure_cyporex.jpg" alt="test" class="carousel__image" />
      <img src="../img/ext1.jpg" alt="test" class="carousel__image" />
      <img src="../img/ext2.jpg" alt="test" class="carousel__image" />
      <img src="../img/exterieur.jpg" alt="test" class="carousel__image" />
      <img src="../img/meuble-laura-1.jpg" alt="test" class="carousel__image" />
      <img src="../img/meuble-laura-2.jpg" alt="test" class="carousel__image" />
      <img src="../img/meuble-laura-3.jpg" alt="test" class="carousel__image" />
      <img src="../img/martegauxavant1.jpg" alt="test" class="carousel__image" />
      <img src="../img/martegauxavant2.jpg" alt="test" class="carousel__image" />
      <img src="../img/martegauxavant3.jpg" alt="test" class="carousel__image" />
      <img src="../img/martegauxB.jpg" alt="test" class="carousel__image" />
      <img src="../img/martegauxC.jpg" alt="test" class="carousel__image" />
      <img src="../img/martegauxD.jpg" alt="test" class="carousel__image" />
      <img src="../img/martegauxE.jpg" alt="test" class="carousel__image" />
      <img src="../img/velaux0.jpg" alt="test" class="carousel__image" />
      <img src="../img/velaux1.jpg" alt="test" class="carousel__image" />
      <img src="../img/velaux2.jpg" alt="test" class="carousel__image" />
      <img src="../img/velaux3.jpg" alt="test" class="carousel__image" />
    </div>
  </div>  
  <script>
    const carousel = document.getElementById("carousel");
    const container = document.getElementById("carousel-container");
    const images = carousel.getElementsByTagName("img");
    const total = images.length;

    function getRootCSSVars() {
      const rootStyles = getComputedStyle(document.documentElement);
      return {
        translateZ: parseInt(rootStyles.getPropertyValue('--translateZ')) || 1000,
        offset: rootStyles.getPropertyValue('--offset') || '-250px',
        perspective: rootStyles.getPropertyValue('--perspective') || '3000px',
        containerTop: rootStyles.getPropertyValue('--container-top') || '30%',
        containerLeft: rootStyles.getPropertyValue('--container-left') || '45%',
        containerTranslateX: rootStyles.getPropertyValue('--container-translate-x') || '-50%',
        containerTranslateY: rootStyles.getPropertyValue('--container-translate-y') || '-49%',
        imgSize: rootStyles.getPropertyValue('--img-size') || '150px'
      };
    }

    function updateContainerStyle() {
      const vars = getRootCSSVars();
      container.style.perspective = vars.perspective;
      container.style.top = vars.containerTop;
      container.style.left = vars.containerLeft;
      container.style.transform = `translate(${vars.containerTranslateX}, ${vars.containerTranslateY})`;
    }

    function updateImageSizes() {
      const vars = getRootCSSVars();
      Array.from(images).forEach(img => {
        img.style.width = vars.imgSize.trim();
        img.style.height = vars.imgSize.trim();
      });
    }

    let baseRadius = 900;
    const Scale = 1.5;
    let angle = 0;
    let autoRotate = true;
    let lastTime = performance.now();
    let velocity = 0;
    const friction = 0.95;
    let isDragging = false;
    let lastX = 0;

    function positionImages() {
      const vars = getRootCSSVars();
      baseRadius = vars.translateZ;
      const offset = vars.offset.trim();
      const angleStep = 360 / total;
      let closestIndex = 0;
      let minDiff = 360;

      for (let i = 0; i < total; i++) {
        const theta = (angleStep * i + angle) % 360;
        const diff = Math.min(Math.abs(theta), Math.abs(360 - theta));
        if (diff < minDiff) {
          minDiff = diff;
          closestIndex = i;
        }
      }

      for (let i = 0; i < total; i++) {
        const theta = angleStep * i + angle;
        const extraRotation = -angleStep * 0.3;

        if (i === closestIndex) {
          images[i].style.transform =
            `rotateY(${theta}deg) translateZ(${baseRadius * 1.6}px) translateY(-20px) rotateY(${extraRotation}deg) scale(${Scale})`;
          images[i].style.zIndex = 100;
          images[i].style.filter = "drop-shadow(0 0 20px rgba(255,255,255,0.6))";
          images[i].style.setProperty('--offset', offset);
        } else {
          images[i].style.transform =
            `rotateY(${theta}deg) translateZ(${baseRadius}px) rotateY(${extraRotation}deg) scale(1)`;
          images[i].style.zIndex = 1;
          images[i].style.filter = "none";
        }
      }
    }

    function animate(now) {
      const delta = now - lastTime;

      if (autoRotate) {
        velocity = 0.0050 * delta;
        angle += velocity;
      } else {
        angle += velocity;
        velocity *= friction;
        if (Math.abs(velocity) < 0.001) {
          autoRotate = true;
          velocity = 0;
        }
      }

      positionImages();
      lastTime = now;
      requestAnimationFrame(animate);
    }

    let interactionTimeout;
    function restartAutoRotate() {
      clearTimeout(interactionTimeout);
      interactionTimeout = setTimeout(() => {
        autoRotate = false;
        velocity = 0.02;
      }, 2000);
    }

    container.addEventListener("wheel", (e) => {
      e.preventDefault();
      autoRotate = false;
      velocity += e.deltaY * 0.003;
      restartAutoRotate();
    });

    container.addEventListener("mousedown", (e) => {
      isDragging = true;
      lastX = e.clientX;
      autoRotate = false;
      velocity = 0;
    });

    window.addEventListener("mouseup", () => {
      if (isDragging) {
        isDragging = false;
        restartAutoRotate();
      }
    });

    window.addEventListener("mousemove", (e) => {
      if (isDragging) {
        const dx = e.clientX - lastX;
        velocity = dx * 0.5;
        angle += velocity;
        lastX = e.clientX;
      }
    });

    container.addEventListener("touchstart", (e) => {
      if (e.touches.length === 1) {
        isDragging = true;
        lastX = e.touches[0].clientX;
        autoRotate = false;
        velocity = 0;
      }
    });

    container.addEventListener("touchend", () => {
      if (isDragging) {
        isDragging = false;
        restartAutoRotate();
      }
    });

    container.addEventListener("touchmove", (e) => {
      if (isDragging && e.touches.length === 1) {
        const dx = e.touches[0].clientX - lastX;
        velocity = dx * 0.5;
        angle += velocity;
        lastX = e.touches[0].clientX;
      }
    });

    window.addEventListener('resize', () => {
      updateContainerStyle();
      updateImageSizes();
      positionImages();
    });

    updateContainerStyle();
    updateImageSizes();
    positionImages();
    requestAnimationFrame(animate);
  </script>
</body>
</html>
